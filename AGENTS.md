# Repository Guidelines

## プロジェクト構造とモジュール構成
- ルート直下には Renovate の共有設定ファイル (`*.json5`, `default.json`) がまとまっており、用途別プレセット名を `automergeFoo.json5` のようにキャメルケースで統一してください。
- `docs/` にはドキュメント資産と日本語 README (`docs/README.ja.md`) があり、ビジュアル素材はここに追加します。
- 新しい設定を追加する際は `default.json` から拡張されることを想定し、依存関係と読み込み順が循環しないように整理します。

## ビルド・テスト・開発コマンド
- `npx --yes renovate-config-validator` を実行してルートの設定ファイル全体を検証し、構文とスキーマの逸脱を即時に検出します。
- 実行環境を固定したい場合は `docker run --rm -v "$PWD:/renovate" renovate/renovate renovate-config-validator` を使い、CI と同等のバージョンで確認します。
- 用語ゆれチェックには `npx --yes cspell "**/*.json5"` を推奨し、`cspell.json` に沿って辞書を管理します。

## コーディングスタイルと命名規約
- JSON/JSON5 は 2 スペースインデント、末尾カンマ可、キーはダブルクォートで統一し、フィールド順は既存ファイルを基準に論理順序を保ちます。
- プリセット名は機能単位のキャメルケース (`automergeTerraform.json5` など) とし、説明コメントはファイル外ドキュメントに集約します。
- 共有プロパティを複製する代わりに `extends` を活用し、重複したルールが発生した場合は専用プリセットへ分割してください。

## テストガイドライン
- 変更ごとに `renovate-config-validator` を実行し、主要プリセット (`default.json`, `platformAutomerge.json5` など) を個別検証して regression を防ぎます。
- 新しい `packageRules` を追加する際は、対象リポジトリ例を PR 説明に記載し、期待する Renovate の挙動を手元で再現したログやスクリーンショットを添付します。
- カバレッジ数値の代わりにサンプル設定ファイルを `docs/` で共有し、適用結果を記録することで同等の検証証跡とします。

## コミットとプルリクエストガイドライン
- Git 履歴は Renovate の自動コミットに合わせて `Update <対象> to vX.Y.Z (#1234)` 形式が多いため、手動変更時も `chore: refine automerge strategy` のように目的が即座に分かる短文を採用します。
- PR では概要、影響範囲、検証コマンド、関連 Issue/ディスカッションを箇条書きで記載し、設定差分のハイライトや期待される Renovate の通知例を添付してください。
- スクリーンショットやログは機密情報を含まない形に加工し、必要に応じて `docs/` 配下に配置してから参照リンクを貼ります。

## セキュリティと設定のヒント
- Renovate 用トークンや認証情報は一切このリポジトリに含めず、GitHub 側の組織シークレットで管理します。
- スケジュールや自動マージ戦略を更新する場合は、フォーク利用者への影響を README に反映し、破壊的変更はメジャーバージョン相当の告知を行ってください。
- 外部ドキュメントへのリンクは公式 Renovate Docs を優先し、非公式情報を参照する際は理由と検証方法を明記します。
